"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[915],{4613:function(e,t,r){r.d(t,{w:function(){return m}});var a=r(8590),s=r(4961);class n{static async setItem(e,t){try{let r=JSON.stringify(t);localStorage.setItem(e,r)}catch(t){throw console.error("Error saving data for key ".concat(e,":"),t),Error("Failed to save data: ".concat(t))}}static async getItem(e){try{let t=localStorage.getItem(e);return null!=t?JSON.parse(t):null}catch(t){return console.error("Error retrieving data for key ".concat(e,":"),t),null}}static async removeItem(e){try{localStorage.removeItem(e)}catch(t){throw console.error("Error removing data for key ".concat(e,":"),t),Error("Failed to remove data: ".concat(t))}}static async clear(){try{localStorage.clear()}catch(e){throw console.error("Error clearing storage:",e),Error("Failed to clear storage: ".concat(e))}}static async getAllKeys(){try{return Object.keys(localStorage)}catch(e){return console.error("Error getting all keys:",e),[]}}static async getStorageSize(){try{let e=await this.getAllKeys(),t=0;for(let r of e){let e=localStorage.getItem(r);e&&(t+=new Blob([e]).size)}return{usedSize:t,totalSize:5242880}}catch(e){return console.error("Error calculating storage size:",e),{usedSize:0,totalSize:0}}}static validateData(e,t){try{return t(e)}catch(e){return{isValid:!1,errors:["Validation error: ".concat(e)]}}}static getStorageKeys(){return Object.freeze({...this.STORAGE_KEYS})}}n.STORAGE_KEYS={USER_PROFILE:"user_profile",IMPORTED_BEERS:"imported_beers",SEARCH_SESSIONS:"search_sessions",PROMPT_TEMPLATES_CACHE:"prompt_templates_cache",APP_SETTINGS:"app_settings"};class i{static async getImportedBeers(){return await n.getItem(this.STORAGE_KEY)||[]}static async addImportedBeer(e){let t={...e,id:(0,a.Z)(),importedAt:new Date,updatedAt:new Date},r=this.validateImportedBeer(t);if(!r.isValid)throw Error("Invalid beer data: ".concat(r.errors.join(", ")));let s=await this.getImportedBeers();return s.push(t),await n.setItem(this.STORAGE_KEY,s),t}static async addImportedBeers(e){let t=e.map(e=>({...e,id:(0,a.Z)(),importedAt:new Date,updatedAt:new Date}));for(let e of t){let t=this.validateImportedBeer(e);if(!t.isValid)throw Error("Invalid beer data for ".concat(e.name,": ").concat(t.errors.join(", ")))}let r=[...await this.getImportedBeers(),...t];return await n.setItem(this.STORAGE_KEY,r),t}static async updateImportedBeer(e,t){let r=await this.getImportedBeers(),a=r.findIndex(t=>t.id===e);if(-1===a)throw Error("Beer with id ".concat(e," not found"));r[a]={...r[a],...t,updatedAt:new Date};let s=this.validateImportedBeer(r[a]);if(!s.isValid)throw Error("Invalid beer data: ".concat(s.errors.join(", ")));await n.setItem(this.STORAGE_KEY,r)}static async deleteImportedBeer(e){let t=await this.getImportedBeers(),r=t.filter(t=>t.id!==e);if(r.length===t.length)throw Error("Beer with id ".concat(e," not found"));await n.setItem(this.STORAGE_KEY,r)}static async getImportedBeer(e){return(await this.getImportedBeers()).find(t=>t.id===e)||null}static async filterBeers(e){return(await this.getImportedBeers()).filter(t=>{if(e.styles&&e.styles.length>0&&!e.styles.includes(t.style)||e.breweries&&e.breweries.length>0&&!e.breweries.includes(t.brewery)||e.ratingRange&&(t.rating<e.ratingRange.min||t.rating>e.ratingRange.max))return!1;if(e.dateRange){let r=new Date(t.checkinDate?t.checkinDate:t.importedAt);if(r<e.dateRange.start||r>e.dateRange.end)return!1}if(e.sources&&e.sources.length>0&&!e.sources.includes(t.source))return!1;if(e.searchText){let r=e.searchText.toLowerCase();if(![t.name,t.brewery,t.style,t.notes||"",...t.tags].join(" ").toLowerCase().includes(r))return!1}return!0})}static async getUniqueStyles(){return Array.from(new Set((await this.getImportedBeers()).map(e=>e.style))).sort()}static async getUniqueBreweries(){return Array.from(new Set((await this.getImportedBeers()).map(e=>e.brewery))).sort()}static async getBeerStats(){let e=await this.getImportedBeers();if(0===e.length)return{totalCount:0,averageRating:0,topBreweries:[],topStyles:[]};let t=e.reduce((e,t)=>e+t.rating,0)/e.length,r=new Map;e.forEach(e=>{r.set(e.brewery,(r.get(e.brewery)||0)+1)});let a=new Map;e.forEach(e=>{a.set(e.style,(a.get(e.style)||0)+1)});let s=Array.from(r.entries()).map(e=>{let[t,r]=e;return{name:t,count:r}}).sort((e,t)=>t.count-e.count).slice(0,5),n=Array.from(a.entries()).map(e=>{let[t,r]=e;return{name:t,count:r}}).sort((e,t)=>t.count-e.count).slice(0,5);return{totalCount:e.length,averageRating:Math.round(10*t)/10,topBreweries:s,topStyles:n}}static async clearAllBeers(){await n.removeItem(this.STORAGE_KEY)}static validateImportedBeer(e){let t=[];return e.id||t.push("Beer ID is required"),e.name&&""!==e.name.trim()||t.push("Beer name is required"),e.brewery&&""!==e.brewery.trim()||t.push("Brewery name is required"),e.style&&""!==e.style.trim()||t.push("Beer style is required"),("number"!=typeof e.rating||e.rating<0||e.rating>5)&&t.push("Rating must be a number between 0 and 5"),void 0!==e.abv&&("number"!=typeof e.abv||e.abv<0||e.abv>100)&&t.push("ABV must be a number between 0 and 100"),void 0!==e.ibu&&("number"!=typeof e.ibu||e.ibu<0)&&t.push("IBU must be a positive number"),Object.values(s.Q8).includes(e.source)||t.push("Invalid import source"),e.tags&&Array.isArray(e.tags)||t.push("Tags must be an array"),e.importedAt||t.push("Import date is required"),{isValid:0===t.length,errors:t}}}i.STORAGE_KEY=n.getStorageKeys().IMPORTED_BEERS;class o{static async getSessions(){return await n.getItem(this.STORAGE_KEY)||[]}static async createSession(e){let t={...e,sessionId:(0,a.Z)(),createdAt:new Date,updatedAt:new Date},r=this.validateSession(t);if(!r.isValid)throw Error("Invalid session data: ".concat(r.errors.join(", ")));let s=await this.getSessions();return s.push(t),await n.setItem(this.STORAGE_KEY,s),t}static async updateSession(e,t){let r=await this.getSessions(),a=r.findIndex(t=>t.sessionId===e);if(-1===a)throw Error("Session with id ".concat(e," not found"));r[a]={...r[a],...t,updatedAt:new Date};let s=this.validateSession(r[a]);if(!s.isValid)throw Error("Invalid session data: ".concat(s.errors.join(", ")));await n.setItem(this.STORAGE_KEY,r)}static async deleteSession(e){let t=await this.getSessions(),r=t.filter(t=>t.sessionId!==e);if(r.length===t.length)throw Error("Session with id ".concat(e," not found"));await n.setItem(this.STORAGE_KEY,r)}static async getSession(e){return(await this.getSessions()).find(t=>t.sessionId===e)||null}static async filterSessions(e){return(await this.getSessions()).filter(t=>{if(e.status&&e.status.length>0&&!e.status.includes(t.status))return!1;if(e.dateRange){let r=new Date(t.createdAt);if(r<e.dateRange.start||r>e.dateRange.end)return!1}if(e.searchText){let r=e.searchText.toLowerCase();if(![t.name||"",t.profile.sessionGoal,t.profile.mood,t.profile.tastePreference.primary,...t.profile.searchKeywords,t.notes||""].join(" ").toLowerCase().includes(r))return!1}return!0})}static async getActiveSession(){return(await this.getSessions()).find(e=>e.status===s.$y.ACTIVE)||null}static async getRecentSessions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;return(await this.getSessions()).sort((e,t)=>new Date(t.updatedAt).getTime()-new Date(e.updatedAt).getTime()).slice(0,e)}static async getSessionStats(){let e=await this.getSessions(),t=e.filter(e=>e.status===s.$y.ACTIVE).length,r=e.filter(e=>e.status===s.$y.COMPLETED).length,a=e.reduce((e,t)=>e+t.generatedPrompts.length,0),n=e.length>0?a/e.length:0;return{totalCount:e.length,activeCount:t,completedCount:r,averagePromptsPerSession:Math.round(10*n)/10}}static async archiveOldSessions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:30,t=await this.getSessions(),r=new Date;r.setDate(r.getDate()-e);let a=0;for(let e of t)e.status===s.$y.COMPLETED&&new Date(e.updatedAt)<r&&(e.status=s.$y.ARCHIVED,e.updatedAt=new Date,a++);return a>0&&await n.setItem(this.STORAGE_KEY,t),a}static async clearAllSessions(){await n.removeItem(this.STORAGE_KEY)}static validateSession(e){let t=[];return e.sessionId||t.push("Session ID is required"),e.userId||t.push("User ID is required"),Object.values(s.$y).includes(e.status)||t.push("Invalid session status"),e.profile?(e.profile.sessionGoal&&""!==e.profile.sessionGoal.trim()||t.push("Session goal is required"),e.profile.mood&&""!==e.profile.mood.trim()||t.push("Mood is required"),e.profile.tastePreference?(e.profile.tastePreference.primary&&""!==e.profile.tastePreference.primary.trim()||t.push("Primary taste preference is required"),Array.isArray(e.profile.tastePreference.avoid)||t.push("Avoid list must be an array"),("number"!=typeof e.profile.tastePreference.intensity||e.profile.tastePreference.intensity<1||e.profile.tastePreference.intensity>5)&&t.push("Intensity must be a number between 1 and 5")):t.push("Taste preference is required"),e.profile.constraints?Array.isArray(e.profile.constraints.other)||t.push("Other constraints must be an array"):t.push("Constraints are required"),Array.isArray(e.profile.searchKeywords)||t.push("Search keywords must be an array")):t.push("Session profile is required"),Array.isArray(e.generatedPrompts)||t.push("Generated prompts must be an array"),e.createdAt||t.push("Created date is required"),{isValid:0===t.length,errors:t}}}o.STORAGE_KEY=n.getStorageKeys().SEARCH_SESSIONS;class c{static async getUserProfile(){return await n.getItem(this.STORAGE_KEY)}static async saveUserProfile(e){let t=this.validateUserProfile(e);if(!t.isValid)throw Error("Invalid user profile: ".concat(t.errors.join(", ")));e.updatedAt=new Date,await n.setItem(this.STORAGE_KEY,e)}static async createUserProfile(e){let t={id:(0,a.Z)(),version:"1.0.0",preferences:{favoriteStyles:[],flavorProfile:{hoppy:3,malty:3,bitter:3,sweet:3,sour:3,alcohol:3},avoidList:[],preferredBreweries:[],budgetRange:{min:0,max:1e4,currency:"JPY"},locationPreferences:[],...e},history:[],sessions:[],settings:{language:"ja-JP",theme:"auto",notifications:!0,dataRetentionDays:365,aiPreference:["chatgpt","claude","gemini"]},createdAt:new Date,updatedAt:new Date};return await this.saveUserProfile(t),t}static async updateUserPreferences(e){let t=await this.getUserProfile();if(!t)throw Error("User profile not found");t.preferences={...t.preferences,...e},await this.saveUserProfile(t)}static async deleteUserProfile(){await n.removeItem(this.STORAGE_KEY)}static async hasUserProfile(){return null!==await this.getUserProfile()}static validateUserProfile(e){let t=[];if(e.id||t.push("User ID is required"),e.version||t.push("Version is required"),e.preferences){let r=e.preferences.flavorProfile;if(r)for(let e of["hoppy","malty","bitter","sweet","sour","alcohol"]){let a=r[e];("number"!=typeof a||a<1||a>5)&&t.push("".concat(e," must be a number between 1 and 5"))}else t.push("Flavor profile is required");let a=e.preferences.budgetRange;a?(a.min<0&&t.push("Budget minimum cannot be negative"),a.max<a.min&&t.push("Budget maximum must be greater than minimum"),a.currency||t.push("Budget currency is required")):t.push("Budget range is required")}else t.push("Preferences are required");return e.settings||t.push("Settings are required"),e.createdAt||t.push("Created date is required"),{isValid:0===t.length,errors:t}}}c.STORAGE_KEY=n.getStorageKeys().USER_PROFILE;class l{static async getSettings(){return await n.getItem(this.STORAGE_KEY)||this.DEFAULT_SETTINGS}static async saveSettings(e){let t=this.validateSettings(e);if(!t.isValid)throw Error("Invalid settings: ".concat(t.errors.join(", ")));await n.setItem(this.STORAGE_KEY,e)}static async updateSettings(e){let t={...await this.getSettings(),...e};await this.saveSettings(t)}static async initializeSettings(){let e=await n.getItem(this.STORAGE_KEY);if(e)return e.launchCount+=1,e.lastLaunch=new Date,await this.saveSettings(e),e;{let e={...this.DEFAULT_SETTINGS,firstLaunch:new Date,lastLaunch:new Date};return await this.saveSettings(e),e}}static async completeOnboarding(){await this.updateSettings({onboardingCompleted:!0})}static async resetOnboarding(){await this.updateSettings({onboardingCompleted:!1})}static async isFirstLaunch(){return 1===(await this.getSettings()).launchCount}static async getStorageInfo(){let e=await this.getSettings();return{usedSize:(await n.getStorageSize()).usedSize,maxSize:e.cacheSettings.maxCacheSize,retentionDays:e.cacheSettings.cacheRetentionDays}}static async updateCacheSettings(e){let t=await this.getSettings();await this.updateSettings({cacheSettings:{...t.cacheSettings,...e}})}static async resetToDefaults(){let e=await this.getSettings(),t={...this.DEFAULT_SETTINGS,firstLaunch:e.firstLaunch,launchCount:e.launchCount,onboardingCompleted:e.onboardingCompleted,lastLaunch:new Date};await this.saveSettings(t)}static async exportSettings(){return JSON.stringify(await this.getSettings(),null,2)}static async importSettings(e){try{let t=JSON.parse(e),r=this.validateSettings(t);if(!r.isValid)throw Error("Invalid settings format: ".concat(r.errors.join(", ")));await this.saveSettings(t)}catch(e){throw Error("Failed to import settings: ".concat(e))}}static async clearSettings(){await n.removeItem(this.STORAGE_KEY)}static validateSettings(e){let t=[];return e.version||t.push("Version is required"),e.firstLaunch||t.push("First launch date is required"),e.lastLaunch||t.push("Last launch date is required"),("number"!=typeof e.launchCount||e.launchCount<0)&&t.push("Launch count must be a non-negative number"),"boolean"!=typeof e.onboardingCompleted&&t.push("Onboarding completed must be a boolean"),"boolean"!=typeof e.dataBackupEnabled&&t.push("Data backup enabled must be a boolean"),"boolean"!=typeof e.analyticsEnabled&&t.push("Analytics enabled must be a boolean"),"boolean"!=typeof e.crashReportingEnabled&&t.push("Crash reporting enabled must be a boolean"),"boolean"!=typeof e.autoUpdateTemplates&&t.push("Auto update templates must be a boolean"),e.cacheSettings?(("number"!=typeof e.cacheSettings.maxCacheSize||e.cacheSettings.maxCacheSize<=0)&&t.push("Max cache size must be a positive number"),("number"!=typeof e.cacheSettings.cacheRetentionDays||e.cacheSettings.cacheRetentionDays<=0)&&t.push("Cache retention days must be a positive number")):t.push("Cache settings are required"),{isValid:0===t.length,errors:t}}}l.STORAGE_KEY=n.getStorageKeys().APP_SETTINGS,l.DEFAULT_SETTINGS={version:"1.0.0",firstLaunch:new Date,lastLaunch:new Date,launchCount:1,onboardingCompleted:!1,dataBackupEnabled:!0,analyticsEnabled:!1,crashReportingEnabled:!1,autoUpdateTemplates:!0,cacheSettings:{maxCacheSize:10485760,cacheRetentionDays:30}};class d{async generateSessionPrompt(e){var t;let r=await this.getTemplate("beer-discovery-session");return r?this.processTemplate(r.template,{sessionGoal:e.sessionGoal,mood:e.mood,primaryTaste:e.tastePreference.primary,avoidTastes:e.tastePreference.avoid.join(", "),location:e.constraints.location||"any location",budget:e.constraints.budget||"any budget",keywords:e.searchKeywords.join(", "),constraints:(null===(t=e.constraints.other)||void 0===t?void 0:t.join(", "))||"none"}):this.generateFallbackPrompt(e)}async getTemplates(){return Array.from(this.templates.values())}async getTemplate(e){return this.templates.get(e)||null}async saveTemplate(e){this.templates.set(e.id,e)}processTemplate(e,t){let r=e;for(let[e,a]of Object.entries(t)){let t="{{".concat(e,"}}");r=r.replace(RegExp(t,"g"),a)}return r}generateFallbackPrompt(e){return"I'm looking for beer recommendations with the following preferences:\n\nGoal: ".concat(e.sessionGoal,"\nMood: ").concat(e.mood,"\nPrimary taste preference: ").concat(e.tastePreference.primary,"\nTastes to avoid: ").concat(e.tastePreference.avoid.join(", ")||"none","\nLocation: ").concat(e.constraints.location||"any","\nBudget: ").concat(e.constraints.budget||"flexible","\nAdditional keywords: ").concat(e.searchKeywords.join(", ")||"none","\n\nPlease provide personalized beer recommendations with detailed explanations of why each beer matches my preferences. Include brewery information, tasting notes, and where I might find these beers.")}initializeDefaultTemplates(){[{id:"beer-discovery-session",name:"Beer Discovery Session",description:"Comprehensive beer recommendation prompt",category:s.AB.SEARCH,version:"1.0.0",locale:"en-US",template:"You are an expert beer sommelier and craft beer specialist. I'm looking for personalized beer recommendations based on my specific preferences and current situation.\n\n**My Current Goal:** {{sessionGoal}}\n**My Mood:** {{mood}}\n**Taste Preferences:** \n- Primary taste I enjoy: {{primaryTaste}}\n- Tastes I want to avoid: {{avoidTastes}}\n\n**Practical Constraints:**\n- Location: {{location}}\n- Budget considerations: {{budget}}\n- Additional requirements: {{constraints}}\n\n**Keywords/Interests:** {{keywords}}\n\nPlease provide me with:\n1. 3-5 specific beer recommendations that match my preferences\n2. Detailed tasting notes for each recommendation\n3. Explanation of why each beer fits my current mood and goal\n4. Brewery information and availability\n5. Food pairing suggestions if relevant\n6. Alternative options if my preferred beers aren't available\n\nFormat your response to be actionable and include specific beer names, brewery names, and style information.",variables:[{name:"sessionGoal",type:"string",required:!0,description:"What the user wants to achieve"},{name:"mood",type:"string",required:!0,description:"Current mood or feeling"},{name:"primaryTaste",type:"string",required:!0,description:"Primary taste preference"},{name:"avoidTastes",type:"string",required:!1,description:"Tastes to avoid"},{name:"location",type:"string",required:!1,description:"User location"},{name:"budget",type:"string",required:!1,description:"Budget constraints"},{name:"constraints",type:"string",required:!1,description:"Additional constraints"},{name:"keywords",type:"string",required:!1,description:"Search keywords"}],metadata:{supportedAI:["chatgpt","claude","gemini"],estimatedTokens:800,difficulty:"easy",tags:["beer","recommendation","discovery"],author:"NextPint Team",language:"English"},createdAt:new Date,updatedAt:new Date},{id:"taste-analysis",name:"Personal Taste Analysis",description:"Analyze beer drinking patterns and preferences",category:s.AB.ANALYSIS,version:"1.0.0",locale:"en-US",template:'As a beer data analyst, please analyze my beer drinking history and provide insights into my taste preferences.\n\n**My Beer History:**\n{{beerHistory}}\n\n**Current Preferences:**\n- Favorite styles: {{favoriteStyles}}\n- Preferred breweries: {{preferredBreweries}}\n- Typical occasions: {{occasions}}\n\nPlease provide:\n1. Analysis of my taste pattern evolution\n2. Identification of my "beer personality type"\n3. Prediction of styles I might enjoy next\n4. Recommendations for expanding my palate\n5. Seasonal drinking patterns if any\n6. Comparison to typical craft beer enthusiast profiles\n\nInclude specific recommendations for new beers to try based on my established preferences.',variables:[{name:"beerHistory",type:"string",required:!0,description:"User beer drinking history"},{name:"favoriteStyles",type:"string",required:!0,description:"Preferred beer styles"},{name:"preferredBreweries",type:"string",required:!1,description:"Favorite breweries"},{name:"occasions",type:"string",required:!1,description:"Typical drinking occasions"}],metadata:{supportedAI:["chatgpt","claude","gemini"],estimatedTokens:600,difficulty:"medium",tags:["analysis","taste","patterns"],author:"NextPint Team",language:"English"},createdAt:new Date,updatedAt:new Date},{id:"brewery-exploration",name:"Brewery Deep Dive",description:"Explore specific breweries and their offerings",category:s.AB.SEARCH,version:"1.0.0",locale:"en-US",template:"I want to explore and learn about specific breweries. Act as a craft beer industry expert.\n\n**Brewery Focus:** {{breweryName}}\n**My Interest Level:** {{interestLevel}}\n**Previous Experience:** {{previousExperience}}\n**What I'm Seeking:** {{seekingType}}\n\nPlease provide comprehensive information about:\n1. Brewery history and founding story\n2. Signature beers and flagship offerings\n3. Brewing philosophy and unique characteristics\n4. Awards and industry recognition\n5. Seasonal or limited releases to watch for\n6. Best beers for beginners vs. advanced drinkers\n7. Food and taproom experience\n8. How to find and purchase their beers\n9. Similar breweries I might also enjoy\n\nMake recommendations specific to my experience level and interests.",variables:[{name:"breweryName",type:"string",required:!0,description:"Name of brewery to explore"},{name:"interestLevel",type:"string",required:!0,description:"User interest level"},{name:"previousExperience",type:"string",required:!1,description:"Previous brewery experience"},{name:"seekingType",type:"string",required:!1,description:"What user is seeking"}],metadata:{supportedAI:["chatgpt","claude","gemini"],estimatedTokens:700,difficulty:"easy",tags:["brewery","exploration","information"],author:"NextPint Team",language:"English"},createdAt:new Date,updatedAt:new Date},{id:"food-pairing",name:"Beer and Food Pairing",description:"Get expert food pairing recommendations",category:s.AB.COMPARISON,version:"1.0.0",locale:"en-US",template:"As a culinary expert specializing in beer and food pairings, help me create the perfect combination.\n\n**Food/Meal:** {{foodDescription}}\n**Occasion:** {{occasion}}\n**Beer Preferences:** {{beerPreferences}}\n**Dietary Restrictions:** {{dietaryRestrictions}}\n**Meal Timing:** {{mealTiming}}\n\nPlease recommend:\n1. 3-5 beer styles that would pair excellently\n2. Specific beer recommendations with brewery names\n3. Explanation of why each pairing works (flavor science)\n4. Alternative pairings for different palates\n5. Serving suggestions (temperature, glassware)\n6. Complementary side dishes or appetizers\n7. Non-alcoholic alternatives if needed\n\nFocus on creating a memorable culinary experience that enhances both the food and beer.",variables:[{name:"foodDescription",type:"string",required:!0,description:"Description of food/meal"},{name:"occasion",type:"string",required:!1,description:"Dining occasion"},{name:"beerPreferences",type:"string",required:!1,description:"Beer preferences"},{name:"dietaryRestrictions",type:"string",required:!1,description:"Dietary restrictions"},{name:"mealTiming",type:"string",required:!1,description:"Meal timing"}],metadata:{supportedAI:["chatgpt","claude","gemini"],estimatedTokens:750,difficulty:"medium",tags:["food","pairing","culinary"],author:"NextPint Team",language:"English"},createdAt:new Date,updatedAt:new Date}].forEach(e=>{this.templates.set(e.id,e)})}constructor(){this.templates=new Map,this.initializeDefaultTemplates()}}class u{trackEvent(e,t){let r={id:this.generateId(),event:e,timestamp:new Date().toISOString(),data:t,sessionId:this.getCurrentSessionId(),userId:this.getCurrentUserId()};this.events.push(r),this.saveEvents()}async getInsights(){let e=await this.getBeerHistory(),t=await this.getSessions();return{totalBeers:e.length,totalSessions:t.length,favoriteStyles:this.analyzeFavoriteStyles(e),breweryPreferences:this.analyzeBreweryPreferences(e),tastingPatterns:this.analyzeTastingPatterns(e),discoveryMetrics:this.analyzeDiscoveryMetrics(e,t),recommendations:this.generateRecommendations(e,t)}}getEvents(e,t){let r=this.events;return e&&(r=r.filter(t=>new Date(t.timestamp)>=e)),t&&(r=r.filter(e=>new Date(e.timestamp)<=t)),r}getEventsByType(e){return this.events.filter(t=>t.event===e)}clearData(){this.events=[],this.saveEvents()}exportData(){return JSON.stringify({events:this.events,exportedAt:new Date().toISOString(),version:"1.0.0"},null,2)}analyzeFavoriteStyles(e){let t=new Map;return e.forEach(e=>{e.style&&t.set(e.style,(t.get(e.style)||0)+1)}),Array.from(t.entries()).sort((e,t)=>{let[,r]=e,[,a]=t;return a-r}).slice(0,5).map(e=>{let[t]=e;return t})}analyzeBreweryPreferences(e){let t=new Map;return e.forEach(e=>{e.brewery&&t.set(e.brewery,(t.get(e.brewery)||0)+1)}),Array.from(t.entries()).sort((e,t)=>{let[,r]=e,[,a]=t;return a-r}).slice(0,5).map(e=>{let[t]=e;return t})}analyzeTastingPatterns(e){var t;let r=new Map,a=new Map;return e.forEach(e=>{if(e.drankAt){let t=new Date(e.drankAt),s=t.toLocaleDateString("en-US",{weekday:"long"}),n=t.getMonth(),i=this.getSeason(n);r.set(s,(r.get(s)||0)+1),a.set(i,(a.get(i)||0)+1)}}),{mostActiveDay:(null===(t=Array.from(r.entries()).sort((e,t)=>{let[,r]=e,[,a]=t;return a-r})[0])||void 0===t?void 0:t[0])||"Saturday",preferredTime:"Evening",seasonalTrends:Object.fromEntries(a)}}analyzeDiscoveryMetrics(e,t){let r=new Date;r.setDate(1);let a=new Set(e.filter(e=>e.drankAt&&new Date(e.drankAt)>=r).map(e=>e.style)),s=Math.min(100,new Set(e.map(e=>e.style)).size/Math.max(e.length,1)*100),n=Math.max(0,100-new Set(e.map(e=>e.name)).size/Math.max(e.length,1)*100);return{newStylesThisMonth:a.size,adventurousnessScore:Math.round(s),consistencyScore:Math.round(n)}}generateRecommendations(e,t){let r=this.analyzeFavoriteStyles(e);return this.analyzeBreweryPreferences(e),{nextStyles:this.getRelatedStyles(r),breweriesToExplore:["Local Craft Breweries","Award Winners","Seasonal Specialists"],personalityType:this.determinePersonalityType(e,t)}}getRelatedStyles(e){let t={IPA:["Double IPA","Session IPA","Hazy IPA","Belgian IPA"],Stout:["Imperial Stout","Coffee Stout","Chocolate Stout","Milk Stout"],Pilsner:["Czech Pilsner","German Pilsner","Italian Pilsner"],Wheat:["Hefeweizen","Witbier","American Wheat","Berliner Weisse"],Porter:["Robust Porter","Smoked Porter","Baltic Porter"],Lager:["Vienna Lager","M\xe4rzen","Schwarzbier","Helles"]},r=new Set;return e.forEach(e=>{(t[e]||[]).forEach(e=>r.add(e))}),Array.from(r).slice(0,3)}determinePersonalityType(e,t){let r=e.length,a=new Set(e.map(e=>e.style)).size/Math.max(r,1);return a>.7?"Explorer - You love trying new styles and breweries":a>.4?"Balanced Drinker - You enjoy both favorites and new discoveries":"Loyalist - You know what you like and stick with favorites"}getSeason(e){return e>=2&&e<=4?"Spring":e>=5&&e<=7?"Summer":e>=8&&e<=10?"Fall":"Winter"}generateId(){return Date.now().toString(36)+Math.random().toString(36).substr(2)}getCurrentSessionId(){return"session_"+Date.now()}getCurrentUserId(){return"user_local"}loadEvents(){try{let e=localStorage.getItem(this.STORAGE_KEY);e&&(this.events=JSON.parse(e))}catch(e){console.error("Failed to load analytics events:",e),this.events=[]}}saveEvents(){try{localStorage.setItem(this.STORAGE_KEY,JSON.stringify(this.events))}catch(e){console.error("Failed to save analytics events:",e)}}async getBeerHistory(){try{let e=localStorage.getItem("nextpint_beer_history");return e?JSON.parse(e):[]}catch(e){}return[]}async getSessions(){try{let e=localStorage.getItem("nextpint_sessions");return e?JSON.parse(e):[]}catch(e){}return[]}constructor(){this.events=[],this.STORAGE_KEY="nextpint_analytics",this.loadEvents()}}class p{async getBeerHistory(){return i.getImportedBeers()}async saveBeerHistory(e){await i.addImportedBeers(e)}async getSessions(){return o.getSessions()}async saveSessions(e){for(let t of e)await o.createSession(t)}async getUserProfile(){return c.getUserProfile()}async saveUserProfile(e){await c.saveUserProfile(e)}async getSettings(){return l.getSettings()}async saveSettings(e){await l.saveSettings(e)}}class m{static getStorageService(){return this.storageService||(this.storageService=new p),this.storageService}static getPromptService(){return this.promptService||(this.promptService=new d),this.promptService}static getAnalyticsService(){return this.analyticsService||(this.analyticsService=new u),this.analyticsService}static setStorageService(e){this.storageService=e}static setPromptService(e){this.promptService=e}static setAnalyticsService(e){this.analyticsService=e}static resetServices(){this.storageService=null,this.promptService=null,this.analyticsService=null}}m.storageService=null,m.promptService=null,m.analyticsService=null},4935:function(e,t,r){r.d(t,{Z:function(){return x}});var a=r(7437),s=r(7138),n=r(6463),i=r(89),o=r(1005),c=r(8184),l=r(4817),d=r(1863),u=r(3907),p=r(8711),m=r(1568),h=r(4258),g=r(4697),y=r(2873),f=r(2265),S=r(4436),b=r(2421);let v=[{code:"ja",name:"日本語",flag:"\uD83C\uDDEF\uD83C\uDDF5"},{code:"en",name:"English",flag:"\uD83C\uDDFA\uD83C\uDDF8"}];function w(){let{i18n:e}=(0,i.$G)(),[t,r]=(0,f.useState)(!1),s=v.find(t=>t.code===e.language)||v[0],n=t=>{e.changeLanguage(t),r(!1)};return(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsxs)("button",{onClick:()=>r(!t),className:"flex items-center gap-2 px-3 py-2 rounded-lg bg-background-secondary hover:bg-background-tertiary transition-colors","aria-label":"言語を変更",children:[(0,a.jsx)(S.Z,{size:16,className:"text-text-secondary"}),(0,a.jsx)("span",{className:"text-sm font-medium",children:s.flag}),(0,a.jsx)(b.Z,{size:14,className:"text-text-secondary transition-transform ".concat(t?"rotate-180":"")})]}),t&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"fixed inset-0 z-10",onClick:()=>r(!1)}),(0,a.jsx)("div",{className:"absolute top-full left-0 mt-2 bg-background-secondary border border-gray-700 rounded-lg shadow-lg z-20 min-w-[140px]",children:v.map(e=>(0,a.jsxs)("button",{onClick:()=>n(e.code),className:"\n                  w-full flex items-center gap-3 px-4 py-3 text-left hover:bg-background-tertiary transition-colors\n                  ".concat(s.code===e.code?"bg-primary-500/10 text-primary-400":"text-text-primary","\n                  first:rounded-t-lg last:rounded-b-lg\n                "),children:[(0,a.jsx)("span",{className:"text-lg",children:e.flag}),(0,a.jsx)("span",{className:"text-sm font-medium",children:e.name})]},e.code))})]})]})}function x(){let e=(0,n.usePathname)(),{t}=(0,i.$G)(),[r,S]=(0,f.useState)(!1),b=[{href:"/home",label:t("navigation.home","ホーム"),icon:o.Z},{href:"/import",label:t("navigation.import","インポート"),icon:c.Z},{href:"/sessions/create",label:t("navigation.search","検索"),icon:l.Z},{href:"/sessions",label:t("navigation.sessions","セッション"),icon:d.Z},{href:"/prompts",label:t("navigation.prompts","プロンプト"),icon:u.Z},{href:"/analytics",label:t("navigation.analytics","分析"),icon:p.Z},{href:"/history",label:t("navigation.history","履歴"),icon:m.Z},{href:"/settings",label:t("navigation.settings","設定"),icon:h.Z}],v=()=>{S(!1)};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("nav",{className:"glass-nav sticky top-0 z-50 border-b border-gray-800 safe-area-top",children:[(0,a.jsx)("div",{className:"mobile-container",children:(0,a.jsxs)("div",{className:"flex items-center justify-between h-16",children:[(0,a.jsxs)(s.default,{href:"/home",className:"flex items-center gap-2 touch-action-manipulation",onClick:v,children:[(0,a.jsx)("span",{className:"text-2xl",children:"\uD83C\uDF7A"}),(0,a.jsx)("span",{className:"text-xl font-bold text-gradient",children:t("app.name","NextPint")})]}),(0,a.jsxs)("div",{className:"hidden lg:flex items-center gap-2",children:[b.slice(0,6).map(t=>{let r=t.icon,n=e===t.href;return(0,a.jsxs)(s.default,{href:t.href,className:"nav-item ".concat(n?"active":""),children:[(0,a.jsx)(r,{size:20}),(0,a.jsx)("span",{className:"hidden xl:inline",children:t.label})]},t.href)}),(0,a.jsx)("div",{className:"ml-4",children:(0,a.jsx)(w,{})})]}),(0,a.jsx)("button",{onClick:()=>{S(!r)},className:"lg:hidden btn-secondary-small","aria-label":"メニューを開く",children:r?(0,a.jsx)(g.Z,{size:20}):(0,a.jsx)(y.Z,{size:20})})]})}),r&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black/50 z-40 lg:hidden",onClick:v}),(0,a.jsx)("div",{className:"\n          fixed top-0 right-0 h-full w-80 max-w-[85vw] bg-background-primary border-l border-gray-800 z-50\n          transform transition-transform duration-300 ease-in-out lg:hidden safe-area-top safe-area-bottom\n          ".concat(r?"translate-x-0":"translate-x-full","\n        "),children:(0,a.jsxs)("div",{className:"flex flex-col h-full",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-gray-800",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-2xl",children:"\uD83C\uDF7A"}),(0,a.jsx)("span",{className:"text-lg font-bold text-gradient",children:"NextPint"})]}),(0,a.jsx)("button",{onClick:v,className:"btn-secondary-small","aria-label":"メニューを閉じる",children:(0,a.jsx)(g.Z,{size:20})})]}),(0,a.jsx)("div",{className:"flex-1 overflow-y-auto scrollbar-hide",children:(0,a.jsx)("div",{className:"p-4 space-y-2",children:b.map(t=>{let r=t.icon,n=e===t.href;return(0,a.jsxs)(s.default,{href:t.href,onClick:v,className:"\n                        flex items-center gap-3 px-4 py-3 rounded-xl transition-all duration-200\n                        ".concat(n?"bg-primary-500/20 text-primary-400 border border-primary-500/30":"text-text-secondary hover:text-text-primary hover:bg-background-secondary","\n                        active:scale-95 touch-action-manipulation\n                      "),children:[(0,a.jsx)(r,{size:22}),(0,a.jsx)("span",{className:"font-medium",children:t.label})]},t.href)})})}),(0,a.jsxs)("div",{className:"p-4 border-t border-gray-800",children:[(0,a.jsx)("div",{className:"mb-4",children:(0,a.jsx)(w,{})}),(0,a.jsx)("div",{className:"text-xs text-text-tertiary text-center",children:"NextPint v1.0"})]})]})})]}),(0,a.jsx)("div",{className:"fixed bottom-0 left-0 right-0 lg:hidden glass-nav border-t border-gray-800 safe-area-bottom z-40",children:(0,a.jsx)("div",{className:"flex items-center justify-around px-2 py-2",children:b.slice(0,5).map(t=>{let r=t.icon,n=e===t.href;return(0,a.jsxs)(s.default,{href:t.href,className:"\n                  flex flex-col items-center gap-1 px-2 py-2 rounded-lg transition-all duration-200\n                  min-w-[60px] touch-action-manipulation active:scale-95\n                  ".concat(n?"text-primary-400":"text-text-tertiary hover:text-text-primary","\n                "),children:[(0,a.jsx)(r,{size:20}),(0,a.jsx)("span",{className:"text-xs font-medium line-clamp-1",children:t.label.split(" ")[0]})]},t.href)})})}),(0,a.jsx)("div",{className:"h-20 lg:hidden"})]})}},4961:function(e,t,r){var a,s,n,i,o,c;r.d(t,{Q8:function(){return a},AB:function(){return n},$y:function(){return s}}),(i=a||(a={})).UNTAPPD="untappd",i.RATEBEER="ratebeer",i.BEERADVOCATE="beeradvocate",i.MANUAL="manual",(o=s||(s={})).ACTIVE="active",o.COMPLETED="completed",o.ARCHIVED="archived",(c=n||(n={})).IMPORT="import",c.SEARCH="search",c.ANALYSIS="analysis",c.COMPARISON="comparison"}}]);